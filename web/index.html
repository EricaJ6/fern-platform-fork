<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fern Platform - Modern Test Intelligence</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <!-- Fallback CSS for when FontAwesome doesn't load -->
    <style>
        /* Icon fallbacks using Unicode symbols */
        .icon-fallback::before {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
            font-style: normal;
            font-weight: bold;
            text-align: center;
        }
        
        /* Only show fallback when FontAwesome fails to load */
        .fas.fa-chart-line::before { content: "üìà"; }
        .fas.fa-chart-pie::before { content: "üìä"; }
        .fas.fa-list-alt::before { content: "üìã"; }
        .fas.fa-heartbeat::before { content: "üíì"; }
        .fas.fa-folder-open::before { content: "üìÇ"; }
        .fas.fa-play-circle::before { content: "‚ñ∂Ô∏è"; }
        .fas.fa-code::before { content: "üíª"; }
        .fas.fa-th-large::before { content: "‚äû"; }
        .fas.fa-chart-bar::before { content: "üìä"; }
        .fas.fa-moon::before { content: "üåô"; }
        .fas.fa-sun::before { content: "‚òÄÔ∏è"; }
        .fas.fa-spinner::before { content: "‚è≥"; }
        .fas.fa-exclamation-triangle::before { content: "‚ö†Ô∏è"; }
        .fas.fa-flask::before { content: "üß™"; }
        .fas.fa-plus-circle::before { content: "‚ûï"; }
        .fas.fa-rocket::before { content: "üöÄ"; }
        .fas.fa-code-branch::before { content: "üåø"; }
        .fas.fa-home::before { content: "üè†"; }
        .fas.fa-chevron-right::before { content: "‚ñ∂"; }
        
        /* Ensure icons work when FontAwesome loads */
        .fas[class*="fa-"]::before {
            font-size: inherit;
            margin-right: 0;
        }
    </style>
    
    <style>
        :root {
            /* Brand Colors - Modern Palette */
            --primary: #10b981;
            --primary-dark: #047857;
            --primary-light: #34d399;
            --secondary: #3b82f6;
            --accent: #8b5cf6;
            
            /* Status Colors */
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --info: #06b6d4;
            --muted: #6b7280;
            
            /* Light Theme */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --bg-elevated: #ffffff;
            --bg-surface: #ffffff;
            
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-tertiary: #94a3b8;
            --text-inverse: #ffffff;
            
            --border-light: #e2e8f0;
            --border-medium: #cbd5e1;
            --border-heavy: #94a3b8;
            
            /* Shadows */
            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            
            /* Border Radius */
            --radius-xs: 0.25rem;
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
            
            /* Transitions */
            --transition-fast: 150ms ease-in-out;
            --transition-normal: 250ms ease-in-out;
            --transition-slow: 350ms ease-in-out;
        }

        /* Dark Theme */
        [data-theme="dark"] {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-tertiary: #334155;
            --bg-elevated: #1e293b;
            --bg-surface: #0f172a;
            
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-tertiary: #64748b;
            --text-inverse: #0f172a;
            
            --border-light: #334155;
            --border-medium: #475569;
            --border-heavy: #64748b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            transition: background-color var(--transition-normal), color var(--transition-normal);
            font-feature-settings: "cv02", "cv03", "cv04", "cv11";
        }
        
        /* Modern Header */
        .header {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-light);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            min-height: 80px;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .logo-container {
            width: 64px;
            height: 64px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            transition: transform var(--transition-fast);
        }
        
        .logo-container:hover {
            transform: scale(1.05);
        }
        
        .logo-image {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: brightness(1.1);
        }
        
        .brand-text h1 {
            font-size: 1.875rem;
            font-weight: 800;
            color: white;
            margin-bottom: 0.25rem;
            letter-spacing: -0.025em;
        }
        
        .brand-text p {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: 1.5rem;
        }
        
        .header-stats {
            display: flex;
            gap: 2rem;
            align-items: center;
        }
        
        .stat-item {
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            display: block;
            line-height: 1.2;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.8);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }
        
        /* Dark Mode Toggle */
        .theme-toggle {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--radius-lg);
            padding: 0.75rem;
            cursor: pointer;
            color: white;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 48px;
            height: 48px;
        }
        
        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: scale(1.05);
        }
        
        .theme-toggle i {
            font-size: 1.125rem;
        }
        
        /* Modern Navigation */
        .navigation {
            background: var(--bg-elevated);
            border-bottom: 1px solid var(--border-light);
            backdrop-filter: blur(20px);
            position: sticky;
            top: 80px;
            z-index: 999;
        }
        
        .nav-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            padding: 0 2rem;
        }
        
        .nav-button {
            background: none;
            border: none;
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all var(--transition-fast);
            border-bottom: 3px solid transparent;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            position: relative;
            overflow: hidden;
        }
        
        .nav-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--primary);
            opacity: 0;
            transition: opacity var(--transition-fast);
            z-index: -1;
        }
        
        .nav-button:hover {
            color: var(--primary);
        }
        
        .nav-button:hover::before {
            opacity: 0.05;
        }
        
        .nav-button.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: rgba(16, 185, 129, 0.05);
        }
        
        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        /* Modern Cards */
        .card {
            background: var(--bg-elevated);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-sm);
            transition: all var(--transition-normal);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
            opacity: 0;
            transition: opacity var(--transition-normal);
        }
        
        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
            border-color: var(--primary);
        }
        
        .card:hover::before {
            opacity: 1;
        }
        
        .card-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1.5rem;
        }
        
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .card-icon {
            width: 3rem;
            height: 3rem;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            position: relative;
            overflow: hidden;
        }
        
        .card-icon::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, currentColor, transparent);
            opacity: 0.1;
        }
        
        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        /* Status Badges */
        .status {
            display: inline-flex;
            align-items: center;
            padding: 0.5rem 1rem;
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
            gap: 0.5rem;
        }
        
        .status.healthy {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .status.active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--primary);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }
        
        .status.inactive {
            background: rgba(107, 114, 128, 0.1);
            color: var(--muted);
            border: 1px solid rgba(107, 114, 128, 0.2);
        }
        
        .status::before {
            content: '';
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
        }
        
        /* Stats */
        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid var(--border-light);
        }
        
        .stat-row:last-child {
            border-bottom: none;
        }
        
        .stat-number {
            font-weight: 700;
            font-size: 1.25rem;
        }
        
        .success { color: var(--success); }
        .error { color: var(--error); }
        .warning { color: var(--warning); }
        .info { color: var(--info); }
        .muted { color: var(--muted); }
        
        /* Modern Treemap */
        .treemap-container {
            background: var(--bg-elevated);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-2xl);
            padding: 2.5rem;
            box-shadow: var(--shadow-md);
            margin-bottom: 3rem;
            position: relative;
            overflow: hidden;
        }
        
        .treemap-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
        }
        
        .treemap-title {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .treemap-title h3 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            letter-spacing: -0.025em;
        }
        
        .treemap-title p {
            color: var(--text-secondary);
            font-size: 1rem;
        }
        
        .treemap-svg {
            width: 100%;
            height: 600px;
            border-radius: var(--radius-xl);
            background: var(--bg-secondary);
            border: 1px solid var(--border-light);
        }
        
        .treemap-cell {
            stroke: var(--bg-primary);
            stroke-width: 3;
            cursor: pointer;
            transition: all var(--transition-normal);
            filter: drop-shadow(0 2px 8px rgba(0,0,0,0.1));
        }
        
        .treemap-cell:hover {
            stroke-width: 4;
            filter: drop-shadow(0 4px 12px rgba(0,0,0,0.2));
            transform: scale(1.02);
        }
        
        .treemap-text-project {
            font-size: 14px;
            font-weight: 700;
            fill: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            pointer-events: none;
            font-family: 'Inter', sans-serif;
        }
        
        .treemap-text-stats {
            font-size: 12px;
            font-weight: 600;
            fill: white;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.8);
            pointer-events: none;
            font-family: 'Inter', sans-serif;
        }
        
        .treemap-text-count {
            font-size: 11px;
            font-weight: 500;
            fill: rgba(255,255,255,0.9);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.6);
            pointer-events: none;
            font-family: 'Inter', sans-serif;
        }
        
        /* Breadcrumb Navigation */
        .breadcrumb {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-light);
        }
        
        .breadcrumb-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--text-secondary);
            font-weight: 500;
            cursor: pointer;
            padding: 0.5rem 0.75rem;
            border-radius: var(--radius-md);
            transition: all var(--transition-fast);
        }
        
        .breadcrumb-item:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }
        
        .breadcrumb-item.active {
            color: var(--primary);
            font-weight: 600;
            cursor: default;
        }
        
        .breadcrumb-item.active:hover {
            background: transparent;
        }
        
        .breadcrumb-separator {
            color: var(--text-tertiary);
            margin: 0 0.25rem;
        }

        /* Modern Tables */
        .table-container {
            background: var(--bg-elevated);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-xl);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th {
            background: var(--bg-secondary);
            padding: 1.25rem 1.5rem;
            text-align: left;
            font-weight: 600;
            color: var(--text-primary);
            border-bottom: 1px solid var(--border-light);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }
        
        td {
            padding: 1.25rem 1.5rem;
            border-bottom: 1px solid var(--border-light);
            vertical-align: top;
        }
        
        tr:hover {
            background: var(--bg-secondary);
        }
        
        /* View Toggle */
        .view-toggle {
            display: flex;
            gap: 0.5rem;
            background: var(--bg-secondary);
            padding: 0.25rem;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-light);
        }
        
        .toggle-button {
            background: none;
            border: none;
            padding: 0.75rem 1.25rem;
            border-radius: var(--radius-md);
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .toggle-button:hover {
            color: var(--primary);
        }
        
        .toggle-button.active {
            background: var(--primary);
            color: white;
            box-shadow: var(--shadow-sm);
        }
        
        /* Loading States */
        .loading, .error-message {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }
        
        .loading i, .error-message i {
            font-size: 3rem;
            margin-bottom: 1rem;
            display: block;
        }
        
        .loading i {
            color: var(--primary);
            animation: spin 1s linear infinite;
        }
        
        .error-message i {
            color: var(--error);
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        /* Empty States */
        .empty-state {
            text-align: center;
            padding: 4rem 2rem;
            color: var(--text-secondary);
        }
        
        .empty-state i {
            font-size: 4rem;
            color: var(--text-tertiary);
            margin-bottom: 1.5rem;
            display: block;
        }
        
        .empty-state h3 {
            font-size: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--text-primary);
            font-weight: 600;
        }
        
        .empty-state p {
            font-size: 1rem;
            max-width: 500px;
            margin: 0 auto;
            line-height: 1.6;
        }
        
        /* Animations */
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(20px);
            }
            to { 
                opacity: 1; 
                transform: translateY(0);
            }
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
                padding: 1rem;
            }
            
            .header-stats {
                gap: 1rem;
                justify-content: center;
            }
            
            .nav-content {
                flex-wrap: wrap;
                padding: 0 1rem;
            }
            
            .container {
                padding: 1rem;
            }
            
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .treemap-svg {
                height: 400px;
            }
            
            .card {
                padding: 1.5rem;
            }
        }
        
        /* Tooltip */
        .treemap-tooltip {
            position: absolute;
            background: var(--bg-primary);
            border: 1px solid var(--border-medium);
            color: var(--text-primary);
            padding: 1rem 1.25rem;
            border-radius: var(--radius-lg);
            font-size: 0.875rem;
            font-weight: 500;
            pointer-events: none;
            z-index: 1000;
            box-shadow: var(--shadow-xl);
            backdrop-filter: blur(20px);
            max-width: 300px;
        }
        
        /* Breadcrumb */
        .breadcrumb {
            margin-bottom: 1.5rem;
            padding: 1rem 1.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.875rem;
        }
        
        .breadcrumb button {
            background: none;
            border: none;
            color: var(--primary);
            cursor: pointer;
            text-decoration: underline;
            padding: 0;
            font-size: inherit;
        }
        
        .breadcrumb-separator {
            color: var(--text-tertiary);
            font-weight: 500;
        }
        
        /* Legends */
        .treemap-legend {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 2rem;
            flex-wrap: wrap;
            padding: 1.5rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-lg);
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 0.875rem;
            font-weight: 500;
            padding: 0.75rem 1.25rem;
            background: var(--bg-elevated);
            border: 1px solid var(--border-light);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-xs);
        }
        
        .legend-color {
            width: 1rem;
            height: 1rem;
            border-radius: var(--radius-xs);
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Theme Management
        function useTheme() {
            const [theme, setTheme] = useState(() => {
                const saved = localStorage.getItem('theme');
                return saved || 'light';
            });

            useEffect(() => {
                document.documentElement.setAttribute('data-theme', theme);
                localStorage.setItem('theme', theme);
            }, [theme]);

            const toggleTheme = () => {
                setTheme(prev => prev === 'light' ? 'dark' : 'light');
            };

            return { theme, toggleTheme };
        }

        // Utility functions
        const formatDate = (dateString) => {
            return new Date(dateString).toLocaleDateString('en-US', {
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        };

        const getTestStatusColor = (passed, failed, skipped, total) => {
            if (total === 0) return '#6b7280';
            
            const passRate = passed / total;
            
            if (passRate >= 0.9) return '#10b981';
            if (passRate >= 0.7) return '#34d399';
            if (passRate >= 0.5) return '#f59e0b';
            if (passRate >= 0.3) return '#f97316';
            return '#ef4444';
        };

        // Simple router for SPA navigation
        function useRouter() {
            const [route, setRoute] = useState(window.location.hash.slice(1) || '/');
            
            useEffect(() => {
                const handleHashChange = () => {
                    setRoute(window.location.hash.slice(1) || '/');
                };
                window.addEventListener('hashchange', handleHashChange);
                return () => window.removeEventListener('hashchange', handleHashChange);
            }, []);
            
            const navigate = (path) => {
                window.location.hash = path;
            };
            
            return { route, navigate };
        }

        // Modern Header component
        function Header({ health, projects, testRuns }) {
            const { theme, toggleTheme } = useTheme();
            const activeProjects = projects.filter(p => p.is_active).length;
            const recentRuns = testRuns.filter(tr => {
                const runDate = new Date(tr.start_time);
                const dayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);
                return runDate > dayAgo;
            }).length;

            return (
                <div className="header">
                    <div className="header-content">
                        <div className="logo-section">
                            <div className="logo-container">
                                <img 
                                    src="/web/images/logo-no-background.png" 
                                    alt="Fern Platform" 
                                    className="logo-image"
                                    onError={(e) => {
                                        e.target.style.display = 'none';
                                        e.target.nextSibling.style.display = 'flex';
                                    }}
                                />
                                <div style={{display: 'none', alignItems: 'center', justifyContent: 'center', width: '100%', height: '100%', fontSize: '2rem', color: 'white'}}>
                                    üåø
                                </div>
                            </div>
                            <div className="brand-text">
                                <h1>Fern Platform</h1>
                                <p>Modern Test Intelligence</p>
                            </div>
                        </div>
                        
                        <div className="header-controls">
                            <div className="header-stats">
                                <div className="stat-item">
                                    <span className="stat-value">{activeProjects}</span>
                                    <span className="stat-label">Active Projects</span>
                                </div>
                                <div className="stat-item">
                                    <span className="stat-value">{testRuns.length}</span>
                                    <span className="stat-label">Total Runs</span>
                                </div>
                                <div className="stat-item">
                                    <span className="stat-value">{recentRuns}</span>
                                    <span className="stat-label">Recent Runs</span>
                                </div>
                            </div>
                            
                            <button className="theme-toggle" onClick={toggleTheme} title="Toggle theme">
                                <i className={theme === 'light' ? 'fas fa-moon' : 'fas fa-sun'}></i>
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // Modern Navigation component
        function Navigation({ route, navigate }) {
            const navItems = [
                { path: '/', label: 'Dashboard', icon: 'fas fa-chart-line' },
                { path: '/test-summaries', label: 'Test Summaries', icon: 'fas fa-chart-pie' },
                { path: '/test-runs', label: 'Test Runs', icon: 'fas fa-list-alt' }
            ];

            return (
                <div className="navigation">
                    <div className="nav-content">
                        {navItems.map(item => (
                            <button 
                                key={item.path}
                                onClick={() => navigate(item.path)}
                                className={`nav-button ${route === item.path ? 'active' : ''}`}
                            >
                                <i className={item.icon}></i>
                                {item.label}
                            </button>
                        ))}
                    </div>
                </div>
            );
        }

        // Enhanced Treemap Visualization
        function TreemapVisualization({ projects, testRuns }) {
            const svgRef = useRef();
            const [currentView, setCurrentView] = useState({ type: 'projects', data: null });
            const [breadcrumb, setBreadcrumb] = useState([]);

            const navigateToView = (viewType, data = null, breadcrumbPath = []) => {
                setCurrentView({ type: viewType, data });
                setBreadcrumb(breadcrumbPath);
            };

            const getStatusColor = (status) => {
                switch (status) {
                    case 'passed': return '#10b981';
                    case 'failed': return '#ef4444';
                    case 'skipped': return '#6b7280';
                    default: return '#e5e7eb';
                }
            };

            const generateTestSuites = (testRun) => {
                if (!testRun) return [];

                const suiteTemplates = [
                    { 
                        name: 'API Tests', 
                        description: 'REST endpoints and GraphQL API tests',
                        weight: 0.6,
                        failureRate: 0.3
                    },
                    { 
                        name: 'Integration Tests', 
                        description: 'End-to-end workflow testing',
                        weight: 0.3,
                        failureRate: 0.15
                    },
                    { 
                        name: 'UI Tests', 
                        description: 'Dashboard and web interface tests',
                        weight: 0.1,
                        failureRate: 0.1
                    }
                ];

                const totalTests = testRun.total_tests || 0;
                if (totalTests === 0) return [];

                return suiteTemplates.map(template => {
                    const suiteTests = Math.max(1, Math.floor(totalTests * template.weight));
                    const suiteFailed = Math.floor(suiteTests * template.failureRate);
                    const suitePassed = suiteTests - suiteFailed;
                    
                    return {
                        name: template.name,
                        description: template.description,
                        total: suiteTests,
                        passed: suitePassed,
                        failed: suiteFailed,
                        skipped: 0,
                        duration: Math.random() * 5000 + 1000,
                        type: 'suite'
                    };
                });
            };

            // Generate individual tests for a suite
            const generateIndividualTests = (suite) => {
                const testNames = [
                    'should authenticate user',
                    'should validate input data',
                    'should handle error cases',
                    'should process requests',
                    'should return correct results',
                    'should check permissions',
                    'should save data correctly',
                    'should load configuration',
                    'should verify responses',
                    'should timeout properly',
                    'should handle exceptions',
                    'should validate schemas',
                    'should process workflows',
                    'should manage sessions',
                    'should cache responses'
                ];

                const tests = [];
                let remainingPassed = suite.passed;
                let remainingFailed = suite.failed;
                let remainingSkipped = suite.skipped;

                for (let i = 0; i < suite.total; i++) {
                    let status;
                    if (remainingPassed > 0) {
                        status = 'passed';
                        remainingPassed--;
                    } else if (remainingFailed > 0) {
                        status = 'failed';
                        remainingFailed--;
                    } else {
                        status = 'skipped';
                        remainingSkipped--;
                    }

                    tests.push({
                        name: testNames[i % testNames.length] + ` ${i + 1}`,
                        status: status,
                        duration: Math.random() * 3000 + 100, // 100ms-3s
                        message: status === 'failed' ? 'Test assertion failed' : '',
                        type: 'test'
                    });
                }

                return tests.sort((a, b) => b.duration - a.duration); // Sort by duration descending
            };

            useEffect(() => {
                if (!projects.length) return;

                const svg = d3.select(svgRef.current);
                svg.selectAll("*").remove();

                const container = svg.node().parentNode;
                const width = container.clientWidth;
                const height = 600;

                // Create tooltip
                const tooltip = d3.select("body").selectAll(".treemap-tooltip").data([1]);
                const tooltipEnter = tooltip.enter().append("div").attr("class", "treemap-tooltip");
                const tooltipMerged = tooltipEnter.merge(tooltip).style("opacity", 0);

                let treemapData = [];

                if (currentView.type === 'projects') {
                    // Level 0: Show all projects
                    projects.forEach(project => {
                        const projectRuns = testRuns.filter(run => run.project_id === project.id);
                        const latestRun = projectRuns[0];

                        if (latestRun) {
                            const suites = generateTestSuites(latestRun);
                            const totalDuration = suites.reduce((sum, suite) => sum + suite.duration, 0);
                            const totalTests = suites.reduce((sum, suite) => sum + suite.total, 0);
                            const totalPassed = suites.reduce((sum, suite) => sum + suite.passed, 0);
                            const totalFailed = suites.reduce((sum, suite) => sum + suite.failed, 0);
                            const totalSkipped = suites.reduce((sum, suite) => sum + suite.skipped, 0);
                            
                            treemapData.push({
                                name: project.name,
                                value: totalDuration,
                                passed: totalPassed,
                                failed: totalFailed,
                                skipped: totalSkipped,
                                total: totalTests,
                                duration: totalDuration,
                                project: project,
                                testRun: latestRun,
                                suites: suites,
                                type: 'project'
                            });
                        }
                    });
                } else if (currentView.type === 'project') {
                    // Level 1: Show suites within a project
                    const project = currentView.data.project;
                    const projectRuns = testRuns.filter(run => run.project_id === project.id);
                    const latestRun = projectRuns[0];

                    if (latestRun) {
                        const suites = generateTestSuites(latestRun);
                        
                        treemapData = suites.map(suite => ({
                            name: suite.name,
                            value: suite.duration,
                            passed: suite.passed,
                            failed: suite.failed,
                            skipped: suite.skipped,
                            total: suite.total,
                            duration: suite.duration,
                            project: project,
                            testRun: latestRun,
                            suite: suite,
                            type: 'suite'
                        }));
                    }
                } else if (currentView.type === 'suite') {
                    // Level 2: Show individual tests in a suite
                    const suite = currentView.data.suite;
                    const tests = generateIndividualTests(suite);
                    
                    treemapData = tests.map(test => ({
                        name: test.name,
                        value: test.duration, // Size by execution time
                        status: test.status,
                        duration: test.duration,
                        message: test.message,
                        type: 'test'
                    }));
                }

                if (treemapData.length === 0) return;

                const hierarchy = d3.hierarchy({ children: treemapData })
                    .sum(d => d.value || d.children?.reduce((sum, child) => sum + child.value, 0) || 1)
                    .sort((a, b) => b.value - a.value);

                const treemap = d3.treemap()
                    .size([width - 40, height - 40])
                    .padding(8)
                    .round(true);

                treemap(hierarchy);

                // Create gradients
                const defs = svg.append("defs");
                hierarchy.leaves().forEach((d, i) => {
                    const gradient = defs.append("linearGradient")
                        .attr("id", `gradient-${i}`)
                        .attr("gradientUnits", "objectBoundingBox")
                        .attr("x1", "0%").attr("y1", "0%")
                        .attr("x2", "100%").attr("y2", "100%");

                    let baseColor;
                    if (currentView.type === 'projects' || currentView.type === 'project') {
                        // Project and suite-level coloring based on pass rate
                        baseColor = getTestStatusColor(d.data.passed, d.data.failed, d.data.skipped, d.data.total);
                    } else if (currentView.type === 'suite') {
                        // Individual test coloring based on status
                        baseColor = getStatusColor(d.data.status);
                    }
                    
                    const darkerColor = d3.color(baseColor).darker(0.4);
                    
                    gradient.append("stop")
                        .attr("offset", "0%")
                        .attr("stop-color", baseColor);
                    
                    gradient.append("stop")
                        .attr("offset", "100%")
                        .attr("stop-color", darkerColor);
                });

                // Draw cells
                const cell = svg.selectAll("g")
                    .data(hierarchy.leaves())
                    .enter().append("g")
                    .attr("transform", d => `translate(${d.x0 + 20},${d.y0 + 20})`);

                cell.append("rect")
                    .attr("class", "treemap-cell")
                    .attr("width", d => d.x1 - d.x0)
                    .attr("height", d => d.y1 - d.y0)
                    .attr("fill", (d, i) => `url(#gradient-${i})`)
                    .attr("rx", 8)
                    .style("cursor", currentView.type !== 'suite' ? "pointer" : "default")
                    .on("click", function(event, d) {
                        if (currentView.type === 'projects' && d.data.type === 'project') {
                            // Navigate to project view (show suites)
                            navigateToView('project', d.data, [
                                { name: 'Projects', type: 'projects', data: null },
                                { name: d.data.project.name, type: 'project', data: d.data }
                            ]);
                        } else if (currentView.type === 'project' && d.data.type === 'suite') {
                            // Navigate to suite view (show individual tests)
                            navigateToView('suite', d.data, [
                                { name: 'Projects', type: 'projects', data: null },
                                { name: d.data.project.name, type: 'project', data: { project: d.data.project } },
                                { name: d.data.suite.name, type: 'suite', data: d.data }
                            ]);
                        }
                    })
                    .on("mouseover", function(event, d) {
                        tooltipMerged.transition().duration(200).style("opacity", .95);
                        
                        let tooltipContent;
                        
                        if (currentView.type === 'projects') {
                            // Project-level tooltip
                            const passRate = d.data.total > 0 ? ((d.data.passed / d.data.total) * 100).toFixed(1) : 0;
                            const duration = (d.data.duration / 1000).toFixed(2);
                            
                            tooltipContent = `
                                <div style="font-weight: 700; margin-bottom: 0.75rem; font-size: 1rem;">${d.data.name}</div>
                                <div style="margin-bottom: 0.5rem; color: var(--text-secondary);">Project Overview</div>
                                <div style="margin-bottom: 0.5rem;">Tests: ${d.data.total} ‚Ä¢ Duration: ${duration}s</div>
                                <div style="margin-bottom: 0.5rem;">‚úÖ ${d.data.passed} ‚Ä¢ ‚ùå ${d.data.failed} ‚Ä¢ ‚è≠Ô∏è ${d.data.skipped}</div>
                                <div style="margin-top: 0.75rem; font-weight: 600; color: ${getTestStatusColor(d.data.passed, d.data.failed, d.data.skipped, d.data.total)};">Pass Rate: ${passRate}%</div>
                                <div style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--text-tertiary);">Click to view test suites</div>
                            `;
                        } else if (currentView.type === 'project') {
                            // Suite-level tooltip
                            const passRate = d.data.total > 0 ? ((d.data.passed / d.data.total) * 100).toFixed(1) : 0;
                            const duration = (d.data.duration / 1000).toFixed(2);
                            
                            tooltipContent = `
                                <div style="font-weight: 700; margin-bottom: 0.75rem; font-size: 1rem;">${d.data.name}</div>
                                <div style="margin-bottom: 0.5rem; color: var(--text-secondary);">Test Suite</div>
                                <div style="margin-bottom: 0.5rem;">Tests: ${d.data.total} ‚Ä¢ Duration: ${duration}s</div>
                                <div style="margin-bottom: 0.5rem;">‚úÖ ${d.data.passed} ‚Ä¢ ‚ùå ${d.data.failed} ‚Ä¢ ‚è≠Ô∏è ${d.data.skipped}</div>
                                <div style="margin-top: 0.75rem; font-weight: 600; color: ${getTestStatusColor(d.data.passed, d.data.failed, d.data.skipped, d.data.total)};">Pass Rate: ${passRate}%</div>
                                <div style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--text-tertiary);">Click to view individual tests</div>
                            `;
                        } else if (currentView.type === 'suite') {
                            // Individual test tooltip
                            const duration = (d.data.duration / 1000).toFixed(3);
                            const statusIcon = d.data.status === 'passed' ? '‚úÖ' : d.data.status === 'failed' ? '‚ùå' : '‚è≠Ô∏è';
                            const statusColor = getStatusColor(d.data.status);
                            
                            tooltipContent = `
                                <div style="font-weight: 700; margin-bottom: 0.75rem; font-size: 1rem;">${d.data.name}</div>
                                <div style="margin-bottom: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <span style="font-size: 1.2rem;">${statusIcon}</span>
                                    <span style="font-weight: 600; color: ${statusColor}; text-transform: uppercase;">${d.data.status}</span>
                                </div>
                                <div style="margin-bottom: 0.5rem;">Duration: ${duration}s</div>
                                ${d.data.message ? `<div style="margin-top: 0.75rem; font-size: 0.875rem; color: var(--error); font-style: italic;">${d.data.message}</div>` : ''}
                            `;
                        }
                        
                        tooltipMerged.html(tooltipContent)
                            .style("left", (event.pageX + 15) + "px")
                            .style("top", (event.pageY - 15) + "px");
                    })
                    .on("mouseout", function() {
                        tooltipMerged.transition().duration(300).style("opacity", 0);
                    });

                // Add text labels
                cell.append("text")
                    .attr("class", "treemap-text-project")
                    .attr("x", 12)
                    .attr("y", 28)
                    .text(d => {
                        const maxLength = Math.floor((d.x1 - d.x0) / 9);
                        return d.data.name.length > maxLength ? 
                            d.data.name.substring(0, maxLength - 3) + "..." : 
                            d.data.name;
                    });

                cell.filter(d => (d.x1 - d.x0) > 120 && (d.y1 - d.y0) > 70)
                    .append("text")
                    .attr("class", "treemap-text-count")
                    .attr("x", 12)
                    .attr("y", d => (d.y1 - d.y0) - 12)
                    .text(d => `${d.data.total} tests ‚Ä¢ ${(d.data.duration / 1000).toFixed(1)}s`);

            }, [projects, testRuns, currentView]);

            if (!projects.length) {
                return (
                    <div className="treemap-container">
                        <div className="empty-state">
                            <i className="fas fa-chart-bar"></i>
                            <h3>No projects available</h3>
                            <p>Create projects to see the interactive treemap visualization</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="treemap-container fade-in">
                    {breadcrumb.length > 0 && (
                        <div className="breadcrumb">
                            {breadcrumb.map((item, index) => (
                                <React.Fragment key={index}>
                                    <div 
                                        className={`breadcrumb-item ${index === breadcrumb.length - 1 ? 'active' : ''}`}
                                        onClick={() => {
                                            if (index < breadcrumb.length - 1) {
                                                // Navigate to the clicked breadcrumb level
                                                const targetItem = breadcrumb[index];
                                                if (targetItem.type === 'projects') {
                                                    navigateToView('projects', null, []);
                                                } else if (targetItem.type === 'project') {
                                                    navigateToView('project', targetItem.data, breadcrumb.slice(0, index + 1));
                                                }
                                            }
                                        }}
                                    >
                                        <i className={index === 0 ? 'fas fa-home' : index === breadcrumb.length - 1 ? 'fas fa-flask' : 'fas fa-folder-open'}></i>
                                        {item.name}
                                    </div>
                                    {index < breadcrumb.length - 1 && (
                                        <div className="breadcrumb-separator">
                                            <i className="fas fa-chevron-right" style={{fontSize: '0.75rem'}}></i>
                                        </div>
                                    )}
                                </React.Fragment>
                            ))}
                        </div>
                    )}
                    <div className="treemap-title">
                        <h3>
                            {currentView.type === 'projects' && 'Project Overview'}
                            {currentView.type === 'project' && `Test Suites: ${currentView.data.project.name}`}
                            {currentView.type === 'suite' && `Individual Tests: ${currentView.data.suite.name}`}
                        </h3>
                        <p>
                            {currentView.type === 'projects' && 'Project-level test performance ‚Ä¢ Size represents total execution time ‚Ä¢ Color indicates overall pass rate'}
                            {currentView.type === 'project' && 'Test suite performance within project ‚Ä¢ Size represents execution time ‚Ä¢ Color indicates pass rate'}
                            {currentView.type === 'suite' && 'Individual test execution times and results ‚Ä¢ Size shows execution time ‚Ä¢ Color shows pass/fail status'}
                        </p>
                    </div>
                    <svg ref={svgRef} className="treemap-svg"></svg>
                    <div className="treemap-legend">
                        {(currentView.type === 'projects' || currentView.type === 'project') ? (
                            <>
                                <div className="legend-item">
                                    <div className="legend-color" style={{background: '#10b981'}}></div>
                                    <span>High Pass Rate (90%+)</span>
                                </div>
                                <div className="legend-item">
                                    <div className="legend-color" style={{background: '#34d399'}}></div>
                                    <span>Good Pass Rate (70-89%)</span>
                                </div>
                                <div className="legend-item">
                                    <div className="legend-color" style={{background: '#f59e0b'}}></div>
                                    <span>Medium Pass Rate (50-69%)</span>
                                </div>
                                <div className="legend-item">
                                    <div className="legend-color" style={{background: '#ef4444'}}></div>
                                    <span>Low Pass Rate (&lt;50%)</span>
                                </div>
                            </>
                        ) : (
                            <>
                                <div className="legend-item">
                                    <div className="legend-color" style={{background: '#10b981'}}></div>
                                    <span>Passed Tests</span>
                                </div>
                                <div className="legend-item">
                                    <div className="legend-color" style={{background: '#ef4444'}}></div>
                                    <span>Failed Tests</span>
                                </div>
                                <div className="legend-item">
                                    <div className="legend-color" style={{background: '#6b7280'}}></div>
                                    <span>Skipped Tests</span>
                                </div>
                            </>
                        )}
                    </div>
                </div>
            );
        }

        // Enhanced Dashboard component
        function Dashboard() {
            const [health, setHealth] = useState(null);
            const [projects, setProjects] = useState([]);
            const [testRuns, setTestRuns] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            useEffect(() => {
                fetchData();
            }, []);

            const fetchData = async () => {
                try {
                    const [healthRes, projectsRes, testRunsRes] = await Promise.all([
                        fetch('/health'),
                        fetch('/api/v1/projects'),
                        fetch('/api/v1/test-runs')
                    ]);

                    const healthData = await healthRes.json();
                    const projectsData = await projectsRes.json();
                    const testRunsData = await testRunsRes.json();

                    setHealth(healthData);
                    setProjects(projectsData.data || []);
                    setTestRuns(testRunsData.data || []);
                    setLoading(false);
                } catch (err) {
                    setError(err.message);
                    setLoading(false);
                }
            };

            if (loading) {
                return (
                    <div className="container">
                        <div className="loading fade-in">
                            <i className="fas fa-spinner"></i>
                            <div style={{fontSize: '1.125rem', fontWeight: '500', marginTop: '1rem'}}>Loading dashboard...</div>
                        </div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="container">
                        <div className="error-message fade-in">
                            <i className="fas fa-exclamation-triangle"></i>
                            <div style={{fontSize: '1.125rem', fontWeight: '500', marginTop: '1rem'}}>Error: {error}</div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="container fade-in">
                    <div className="dashboard-grid">
                        <div className="card">
                            <div className="card-header">
                                <h3 className="card-title">
                                    <div className="card-icon" style={{color: 'var(--success)'}}>
                                        <i className="fas fa-heartbeat"></i>
                                    </div>
                                    Platform Health
                                </h3>
                            </div>
                            <div className="stat-row">
                                <span style={{fontWeight: '500'}}>Service Status</span>
                                <span className={`status ${health?.status === 'healthy' ? 'healthy' : 'inactive'}`}>
                                    {health?.status || 'Unknown'}
                                </span>
                            </div>
                            <div className="stat-row">
                                <span style={{fontWeight: '500'}}>Service</span>
                                <span className="stat-number">{health?.service || 'fern-platform'}</span>
                            </div>
                            <div className="stat-row">
                                <span style={{fontWeight: '500'}}>Last Updated</span>
                                <span style={{fontWeight: '600', color: 'var(--text-secondary)'}}>
                                    {health?.timestamp ? formatDate(health.timestamp) : 'N/A'}
                                </span>
                            </div>
                        </div>

                        <div className="card">
                            <div className="card-header">
                                <h3 className="card-title">
                                    <div className="card-icon" style={{color: 'var(--primary)'}}>
                                        <i className="fas fa-folder-open"></i>
                                    </div>
                                    Projects
                                </h3>
                            </div>
                            <div className="stat-row">
                                <span style={{fontWeight: '500'}}>Total Projects</span>
                                <span className="stat-number">{projects.length}</span>
                            </div>
                            <div className="stat-row">
                                <span style={{fontWeight: '500'}}>Active Projects</span>
                                <span className="stat-number success">{projects.filter(p => p.is_active).length}</span>
                            </div>
                            {projects.length === 0 && (
                                <div className="empty-state" style={{padding: '2rem 1rem'}}>
                                    <i className="fas fa-plus-circle" style={{fontSize: '2rem', marginBottom: '0.75rem'}}></i>
                                    <p style={{fontSize: '0.875rem'}}>No projects found. Create your first project via API.</p>
                                </div>
                            )}
                        </div>

                        <div className="card">
                            <div className="card-header">
                                <h3 className="card-title">
                                    <div className="card-icon" style={{color: 'var(--info)'}}>
                                        <i className="fas fa-play-circle"></i>
                                    </div>
                                    Test Runs
                                </h3>
                            </div>
                            <div className="stat-row">
                                <span style={{fontWeight: '500'}}>Total Runs</span>
                                <span className="stat-number">{testRuns.length}</span>
                            </div>
                            <div className="stat-row">
                                <span style={{fontWeight: '500'}}>Recent Runs (24h)</span>
                                <span className="stat-number info">{testRuns.filter(tr => {
                                    const runDate = new Date(tr.start_time);
                                    const dayAgo = new Date(Date.now() - 24 * 60 * 60 * 1000);
                                    return runDate > dayAgo;
                                }).length}</span>
                            </div>
                            {testRuns.length === 0 && (
                                <div className="empty-state" style={{padding: '2rem 1rem'}}>
                                    <i className="fas fa-rocket" style={{fontSize: '2rem', marginBottom: '0.75rem'}}></i>
                                    <p style={{fontSize: '0.875rem'}}>No test runs found. Submit test results via API.</p>
                                </div>
                            )}
                        </div>
                    </div>

                    <div className="card">
                        <div className="card-header">
                            <h3 className="card-title">
                                <div className="card-icon" style={{color: 'var(--accent)'}}>
                                    <i className="fas fa-code"></i>
                                </div>
                                API Endpoints
                            </h3>
                        </div>
                        <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '1rem'}}>
                            {[
                                { method: 'GET', endpoint: '/health', desc: 'Service health check' },
                                { method: 'GET', endpoint: '/api/v1/projects', desc: 'List all projects' },
                                { method: 'POST', endpoint: '/api/v1/projects', desc: 'Create new project' },
                                { method: 'GET', endpoint: '/api/v1/test-runs', desc: 'List all test runs' },
                                { method: 'POST', endpoint: '/api/v1/test-runs', desc: 'Create new test run' },
                                { method: 'GET', endpoint: '/graphql', desc: 'GraphQL playground' }
                            ].map((api, index) => (
                                <div key={index} style={{
                                    display: 'flex',
                                    alignItems: 'center',
                                    gap: '1rem',
                                    padding: '1rem',
                                    background: 'var(--bg-secondary)',
                                    border: '1px solid var(--border-light)',
                                    borderRadius: 'var(--radius-lg)',
                                    fontSize: '0.875rem',
                                    transition: 'all var(--transition-fast)'
                                }}>
                                    <span style={{
                                        background: api.method === 'GET' ? 'var(--info)' : 'var(--primary)',
                                        color: 'white',
                                        padding: '0.375rem 0.75rem',
                                        borderRadius: 'var(--radius-md)',
                                        fontSize: '0.75rem',
                                        fontWeight: '700',
                                        minWidth: '55px',
                                        textAlign: 'center'
                                    }}>
                                        {api.method}
                                    </span>
                                    <code style={{
                                        fontFamily: 'Monaco, Consolas, monospace', 
                                        color: 'var(--text-primary)',
                                        fontWeight: '500',
                                        background: 'var(--bg-tertiary)',
                                        padding: '0.25rem 0.5rem',
                                        borderRadius: 'var(--radius-sm)',
                                        fontSize: '0.8rem'
                                    }}>
                                        {api.endpoint}
                                    </code>
                                    <span style={{color: 'var(--text-secondary)', fontSize: '0.8rem'}}>
                                        {api.desc}
                                    </span>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }

        // Enhanced Test Summaries component
        function TestSummaries() {
            const [projects, setProjects] = useState([]);
            const [testRuns, setTestRuns] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [viewMode, setViewMode] = useState('grid');

            useEffect(() => {
                fetchData();
            }, []);

            const fetchData = async () => {
                try {
                    const [projectsRes, testRunsRes] = await Promise.all([
                        fetch('/api/v1/projects'),
                        fetch('/api/v1/test-runs')
                    ]);

                    const projectsData = await projectsRes.json();
                    const testRunsData = await testRunsRes.json();

                    setProjects(projectsData.data || []);
                    setTestRuns(testRunsData.data || []);
                    setLoading(false);
                } catch (err) {
                    setError(err.message);
                    setLoading(false);
                }
            };

            if (loading) {
                return (
                    <div className="container">
                        <div className="loading fade-in">
                            <i className="fas fa-spinner"></i>
                            <div style={{fontSize: '1.125rem', fontWeight: '500', marginTop: '1rem'}}>Loading test summaries...</div>
                        </div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="container">
                        <div className="error-message fade-in">
                            <i className="fas fa-exclamation-triangle"></i>
                            <div style={{fontSize: '1.125rem', fontWeight: '500', marginTop: '1rem'}}>Error: {error}</div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="container fade-in">
                    <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '2rem'}}>
                        <h2 style={{color: 'var(--text-primary)', fontSize: '2rem', fontWeight: '700', letterSpacing: '-0.025em'}}>
                            <i className="fas fa-chart-pie" style={{marginRight: '0.75rem', color: 'var(--primary)'}}></i>
                            Test Summaries
                        </h2>
                        
                        <div className="view-toggle">
                            <button 
                                className={`toggle-button ${viewMode === 'grid' ? 'active' : ''}`}
                                onClick={() => setViewMode('grid')}
                            >
                                <i className="fas fa-th-large"></i>
                                Grid View
                            </button>
                            <button 
                                className={`toggle-button ${viewMode === 'treemap' ? 'active' : ''}`}
                                onClick={() => setViewMode('treemap')}
                            >
                                <i className="fas fa-chart-bar"></i>
                                Treemap View
                            </button>
                        </div>
                    </div>

                    {viewMode === 'treemap' && (
                        <TreemapVisualization projects={projects} testRuns={testRuns} />
                    )}
                    
                    {viewMode === 'grid' && projects.length > 0 && (
                        <div style={{display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(400px, 1fr))', gap: '2rem'}}>
                            {projects.map(project => {
                                const projectRuns = testRuns.filter(run => run.project_id === project.id);
                                const totalTests = projectRuns.reduce((sum, run) => sum + (run.total_tests || 0), 0);
                                const passedTests = projectRuns.reduce((sum, run) => sum + (run.passed_tests || 0), 0);
                                const failedTests = projectRuns.reduce((sum, run) => sum + (run.failed_tests || 0), 0);

                                return (
                                    <div key={project.id} className="card">
                                        <div className="card-header">
                                            <div>
                                                <h3 style={{margin: '0 0 0.5rem 0', color: 'var(--text-primary)', fontSize: '1.25rem', fontWeight: '600'}}>
                                                    {project.name}
                                                </h3>
                                                <p style={{margin: 0, color: 'var(--text-secondary)', fontSize: '0.875rem'}}>
                                                    {project.description || 'No description provided'}
                                                </p>
                                            </div>
                                            <span className={`status ${project.is_active ? 'active' : 'inactive'}`}>
                                                {project.is_active ? 'Active' : 'Inactive'}
                                            </span>
                                        </div>

                                        <div style={{marginBottom: '1.5rem'}}>
                                            <div style={{display: 'grid', gridTemplateColumns: 'repeat(2, 1fr)', gap: '1rem', marginBottom: '1rem'}}>
                                                <div style={{textAlign: 'center', padding: '1rem', background: 'var(--bg-secondary)', borderRadius: 'var(--radius-lg)', border: '1px solid var(--border-light)'}}>
                                                    <div style={{fontSize: '1.5rem', fontWeight: '700', color: 'var(--text-primary)'}}>{totalTests}</div>
                                                    <div style={{fontSize: '0.75rem', color: 'var(--text-tertiary)', textTransform: 'uppercase', letterSpacing: '0.5px'}}>Total Tests</div>
                                                </div>
                                                <div style={{textAlign: 'center', padding: '1rem', background: 'var(--bg-secondary)', borderRadius: 'var(--radius-lg)', border: '1px solid var(--border-light)'}}>
                                                    <div style={{fontSize: '1.5rem', fontWeight: '700', color: 'var(--text-primary)'}}>{projectRuns.length}</div>
                                                    <div style={{fontSize: '0.75rem', color: 'var(--text-tertiary)', textTransform: 'uppercase', letterSpacing: '0.5px'}}>Test Runs</div>
                                                </div>
                                            </div>
                                            
                                            <div style={{display: 'flex', gap: '1rem', justifyContent: 'center', flexWrap: 'wrap'}}>
                                                <span style={{fontSize: '0.875rem', fontWeight: '500'}}>
                                                    <span className="success" style={{fontSize: '1.125rem', fontWeight: '700'}}>{passedTests}</span> passed
                                                </span>
                                                <span style={{fontSize: '0.875rem', fontWeight: '500'}}>
                                                    <span className="error" style={{fontSize: '1.125rem', fontWeight: '700'}}>{failedTests}</span> failed
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    )}

                    {projects.length === 0 && (
                        <div className="empty-state">
                            <i className="fas fa-folder-open"></i>
                            <h3>No projects found</h3>
                            <p>Create your first project to see comprehensive test summaries and visualizations here.</p>
                        </div>
                    )}
                </div>
            );
        }

        // Enhanced Test Runs component
        function TestRuns() {
            const [testRuns, setTestRuns] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);

            useEffect(() => {
                fetchData();
            }, []);

            const fetchData = async () => {
                try {
                    const response = await fetch('/api/v1/test-runs');
                    const data = await response.json();
                    setTestRuns(data.data || []);
                    setLoading(false);
                } catch (err) {
                    setError(err.message);
                    setLoading(false);
                }
            };

            if (loading) {
                return (
                    <div className="container">
                        <div className="loading fade-in">
                            <i className="fas fa-spinner"></i>
                            <div style={{fontSize: '1.125rem', fontWeight: '500', marginTop: '1rem'}}>Loading test runs...</div>
                        </div>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="container">
                        <div className="error-message fade-in">
                            <i className="fas fa-exclamation-triangle"></i>
                            <div style={{fontSize: '1.125rem', fontWeight: '500', marginTop: '1rem'}}>Error: {error}</div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="container fade-in">
                    <h2 style={{marginBottom: '2rem', color: 'var(--text-primary)', fontSize: '2rem', fontWeight: '700', letterSpacing: '-0.025em'}}>
                        <i className="fas fa-list-alt" style={{marginRight: '0.75rem', color: 'var(--primary)'}}></i>
                        Test Runs
                    </h2>
                    
                    {testRuns.length > 0 ? (
                        <div className="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Project</th>
                                        <th>Run ID</th>
                                        <th>Branch</th>
                                        <th>Test Results</th>
                                        <th>Status</th>
                                        <th>Duration</th>
                                        <th>Started</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {testRuns.map((run) => (
                                        <tr key={run.id}>
                                            <td>
                                                <div style={{fontWeight: '600', fontSize: '0.875rem'}}>{run.project_name || run.project_id}</div>
                                                <div style={{fontSize: '0.75rem', color: 'var(--text-tertiary)'}}>
                                                    {run.environment || 'default'}
                                                </div>
                                            </td>
                                            <td>
                                                <code style={{fontSize: '0.75rem', background: 'var(--bg-tertiary)', padding: '0.375rem 0.75rem', borderRadius: 'var(--radius-md)', fontWeight: '500'}}>
                                                    {run.run_id}
                                                </code>
                                            </td>
                                            <td>
                                                <span style={{display: 'flex', alignItems: 'center', gap: '0.5rem', fontSize: '0.875rem', fontWeight: '500'}}>
                                                    <i className="fas fa-code-branch" style={{fontSize: '0.75rem', color: 'var(--text-tertiary)'}}></i>
                                                    {run.branch || 'main'}
                                                </span>
                                            </td>
                                            <td>
                                                <div style={{display: 'flex', gap: '0.75rem', alignItems: 'center', fontSize: '0.875rem', fontWeight: '500'}}>
                                                    <span className="success">{run.passed_tests || 0}</span>
                                                    <span className="error">{run.failed_tests || 0}</span>
                                                    <span className="muted">{run.skipped_tests || 0}</span>
                                                </div>
                                                <div style={{fontSize: '0.75rem', color: 'var(--text-tertiary)', marginTop: '0.25rem'}}>
                                                    {run.total_tests || 0} total tests
                                                </div>
                                            </td>
                                            <td>
                                                <span className={`status ${run.status === 'completed' ? 'healthy' : 'active'}`}>
                                                    {run.status}
                                                </span>
                                            </td>
                                            <td style={{fontWeight: '500'}}>
                                                {run.duration_ms ? `${(run.duration_ms / 1000).toFixed(1)}s` : 'N/A'}
                                            </td>
                                            <td style={{fontWeight: '500', color: 'var(--text-secondary)'}}>{formatDate(run.start_time)}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    ) : (
                        <div className="empty-state">
                            <i className="fas fa-flask"></i>
                            <h3>No test runs found</h3>
                            <p>Test runs will appear here once you submit test results via the API. Get started by running your first test suite.</p>
                        </div>
                    )}
                </div>
            );
        }

        // Main App component
        function FernPlatform() {
            const { route, navigate } = useRouter();
            const [appData, setAppData] = useState({ health: null, projects: [], testRuns: [] });

            useEffect(() => {
                fetchAppData();
            }, []);

            const fetchAppData = async () => {
                try {
                    const [healthRes, projectsRes, testRunsRes] = await Promise.all([
                        fetch('/health'),
                        fetch('/api/v1/projects'),
                        fetch('/api/v1/test-runs')
                    ]);

                    const health = await healthRes.json();
                    const projects = await projectsRes.json();
                    const testRuns = await testRunsRes.json();

                    setAppData({
                        health,
                        projects: projects.data || [],
                        testRuns: testRuns.data || []
                    });
                } catch (err) {
                    console.error('Failed to fetch app data:', err);
                }
            };

            const renderPage = () => {
                switch (route) {
                    case '/test-summaries':
                        return <TestSummaries />;
                    case '/test-runs':
                        return <TestRuns />;
                    default:
                        return <Dashboard />;
                }
            };

            return (
                <div>
                    <Header {...appData} />
                    <Navigation route={route} navigate={navigate} />
                    {renderPage()}
                </div>
            );
        }

        ReactDOM.render(<FernPlatform />, document.getElementById('root'));
    </script>
</body>
</html>